metadata:
 description: Devfile to assist with Open Telemetry
 displayName: RH Open Telemetry
 name: module5-dotnet-workspace
schemaVersion: 2.2.2

components:
- container:
   args:
   - tail
   - -f
   - /dev/null
   endpoints:
   - name: https-dotnet
     protocol: https
     targetPort: 5000
   env:   
   - name: countryCode
     value: "fr"  
   image: image-registry.openshift-image-registry.svc.cluster.local:5000/openshift/devspaces-dotnet-python:latest
   mountSources: true
  name: dotnet

commands:
  - exec:
      commandLine: dotnet clean
      component: dotnet
      group:
        kind: build
      workingDir: ${PROJECT_SOURCE}
    id: dotnet-clean
  - exec:
      commandLine: dotnet restore
      component: dotnet
      group:
        kind: build
      workingDir: ${PROJECT_SOURCE}
    id: dotnet-restore
  - exec:
      commandLine: dotnet build
      component: dotnet
      group:
        kind: build
      workingDir: ${PROJECT_SOURCE}
    id: dotnet-build

  - exec:
      commandLine: dotnet run --urls "http://0.0.0.0:5000"
      component: dotnet
      group:
        kind: run
      workingDir: ${PROJECT_SOURCE}
    id: run-dotnet
